{"ast":null,"code":"var _jsxFileName = \"/media/rk/disk2/React/Typescript/crwn-clothing-redux/src/components/payment-form/payment-form.component.tsx\",\n  _s = $RefreshSig$();\nimport { useSelector } from \"react-redux\";\nimport { useState } from \"react\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { selectCartTotal } from \"../../store/cart/cart.selector\";\nimport { selectCurrentUser } from \"../../store/user/user.selector\";\nimport { BUTTON_TYPE_CLASSES } from \"../button/button.component\";\nimport { PaymentFormContainer, FormContainer, PaymentButton } from \"./payment-form.styles\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ifValidCardElement = card => card !== null;\nconst PaymentForm = () => {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const amount = useSelector(selectCartTotal);\n  const currentUser = useSelector(selectCurrentUser);\n  const [isProcessingPayment, setIsProcessingPayment] = useState(false);\n  const paymentHandler = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) {\n      return;\n    }\n    setIsProcessingPayment(true);\n    const response = await fetch('/.netlify/functions/create-payment-intent', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        amount: amount * 100\n      })\n    }).then(res => res.json());\n    const {\n      paymentIntent: {\n        client_secret\n      }\n    } = response;\n    const cardDetails = elements.getElement(CardElement);\n    if (!ifValidCardElement(cardDetails)) return;\n    const paymentResult = stripe.confirmCardPayment(client_secret, {\n      payment_method: {\n        card: cardDetails,\n        billing_details: {\n          name: currentUser ? currentUser.displayName : 'Guest'\n        }\n      }\n    });\n    setIsProcessingPayment(false);\n    if ((await paymentResult).error) {\n      alert((await paymentResult).error);\n    } else {\n      if ((await paymentResult).paymentIntent.status === 'succeeded') {\n        alert('Payment Successful');\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(PaymentFormContainer, {\n    children: /*#__PURE__*/_jsxDEV(FormContainer, {\n      onSubmit: paymentHandler,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \" Credit Card Payment: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(CardElement, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(PaymentButton, {\n        isLoading: isProcessingPayment,\n        buttonType: BUTTON_TYPE_CLASSES.inverted,\n        children: \" Pay Now \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 9\n  }, this);\n};\n_s(PaymentForm, \"zeZvNGpoSXJVIJ/CUzfiu8Kc5to=\", false, function () {\n  return [useStripe, useElements, useSelector, useSelector];\n});\n_c = PaymentForm;\nexport default PaymentForm;\nvar _c;\n$RefreshReg$(_c, \"PaymentForm\");","map":{"version":3,"names":["useSelector","useState","CardElement","useStripe","useElements","selectCartTotal","selectCurrentUser","BUTTON_TYPE_CLASSES","PaymentFormContainer","FormContainer","PaymentButton","jsxDEV","_jsxDEV","ifValidCardElement","card","PaymentForm","_s","stripe","elements","amount","currentUser","isProcessingPayment","setIsProcessingPayment","paymentHandler","e","preventDefault","response","fetch","method","headers","body","JSON","stringify","then","res","json","paymentIntent","client_secret","cardDetails","getElement","paymentResult","confirmCardPayment","payment_method","billing_details","name","displayName","error","alert","status","children","onSubmit","fileName","_jsxFileName","lineNumber","columnNumber","isLoading","buttonType","inverted","_c","$RefreshReg$"],"sources":["/media/rk/disk2/React/Typescript/crwn-clothing-redux/src/components/payment-form/payment-form.component.tsx"],"sourcesContent":["import { useSelector } from \"react-redux\";\nimport { useState, FormEvent } from \"react\";\nimport { StripeCardElement } from \"@stripe/stripe-js\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\n\n\nimport { selectCartTotal } from \"../../store/cart/cart.selector\";\nimport { selectCurrentUser } from \"../../store/user/user.selector\";\nimport { BUTTON_TYPE_CLASSES } from \"../button/button.component\";\nimport { PaymentFormContainer, FormContainer, PaymentButton } from \"./payment-form.styles\";\n\nconst ifValidCardElement = (card: StripeCardElement | null): card is StripeCardElement => card !== null;\n\nconst PaymentForm = () => {\n    const stripe = useStripe();\n    const elements = useElements();\n    const amount = useSelector(selectCartTotal);\n    const currentUser = useSelector(selectCurrentUser);\n\n    const [isProcessingPayment, setIsProcessingPayment] = useState(false);\n\n    const paymentHandler = async (e: FormEvent<HTMLFormElement>) => {\n        e.preventDefault();\n\n        if (!stripe || !elements) {\n            return;\n        }\n\n        setIsProcessingPayment(true);\n        \n        const response = await fetch('/.netlify/functions/create-payment-intent', {\n            method: 'post',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ amount: amount * 100 })\n        }).then(res => res.json());\n\n        const {paymentIntent: {client_secret}} = response;\n\n        const cardDetails = elements.getElement(CardElement);\n\n        if (!ifValidCardElement(cardDetails)) return;\n\n        const paymentResult = stripe.confirmCardPayment(client_secret, {\n            payment_method: {\n                card: cardDetails,\n                billing_details: {\n                    name: currentUser ? currentUser.displayName : 'Guest'\n                }\n            }\n        });\n\n        setIsProcessingPayment(false);\n\n        if ((await paymentResult).error) {\n            alert((await paymentResult).error);\n        } else {\n            if ((await paymentResult).paymentIntent.status === 'succeeded') {\n                alert('Payment Successful');\n            }\n        }\n    };\n    \n    return (\n        <PaymentFormContainer>\n            <FormContainer onSubmit={paymentHandler}>\n                <h2> Credit Card Payment: </h2>\n                <CardElement />\n                <PaymentButton isLoading={isProcessingPayment} buttonType={BUTTON_TYPE_CLASSES.inverted}> Pay Now </PaymentButton>\n            </FormContainer>\n        </PaymentFormContainer>\n    );\n};\n\nexport default PaymentForm;"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,aAAa;AACzC,SAASC,QAAQ,QAAmB,OAAO;AAE3C,SAASC,WAAW,EAAEC,SAAS,EAAEC,WAAW,QAAQ,yBAAyB;AAG7E,SAASC,eAAe,QAAQ,gCAAgC;AAChE,SAASC,iBAAiB,QAAQ,gCAAgC;AAClE,SAASC,mBAAmB,QAAQ,4BAA4B;AAChE,SAASC,oBAAoB,EAAEC,aAAa,EAAEC,aAAa,QAAQ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3F,MAAMC,kBAAkB,GAAIC,IAA8B,IAAgCA,IAAI,KAAK,IAAI;AAEvG,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACtB,MAAMC,MAAM,GAAGd,SAAS,CAAC,CAAC;EAC1B,MAAMe,QAAQ,GAAGd,WAAW,CAAC,CAAC;EAC9B,MAAMe,MAAM,GAAGnB,WAAW,CAACK,eAAe,CAAC;EAC3C,MAAMe,WAAW,GAAGpB,WAAW,CAACM,iBAAiB,CAAC;EAElD,MAAM,CAACe,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGrB,QAAQ,CAAC,KAAK,CAAC;EAErE,MAAMsB,cAAc,GAAG,MAAOC,CAA6B,IAAK;IAC5DA,CAAC,CAACC,cAAc,CAAC,CAAC;IAElB,IAAI,CAACR,MAAM,IAAI,CAACC,QAAQ,EAAE;MACtB;IACJ;IAEAI,sBAAsB,CAAC,IAAI,CAAC;IAE5B,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAAC,2CAA2C,EAAE;MACtEC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACL,cAAc,EAAE;MACpB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEb,MAAM,EAAEA,MAAM,GAAG;MAAI,CAAC;IACjD,CAAC,CAAC,CAACc,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC;IAE1B,MAAM;MAACC,aAAa,EAAE;QAACC;MAAa;IAAC,CAAC,GAAGX,QAAQ;IAEjD,MAAMY,WAAW,GAAGpB,QAAQ,CAACqB,UAAU,CAACrC,WAAW,CAAC;IAEpD,IAAI,CAACW,kBAAkB,CAACyB,WAAW,CAAC,EAAE;IAEtC,MAAME,aAAa,GAAGvB,MAAM,CAACwB,kBAAkB,CAACJ,aAAa,EAAE;MAC3DK,cAAc,EAAE;QACZ5B,IAAI,EAAEwB,WAAW;QACjBK,eAAe,EAAE;UACbC,IAAI,EAAExB,WAAW,GAAGA,WAAW,CAACyB,WAAW,GAAG;QAClD;MACJ;IACJ,CAAC,CAAC;IAEFvB,sBAAsB,CAAC,KAAK,CAAC;IAE7B,IAAI,CAAC,MAAMkB,aAAa,EAAEM,KAAK,EAAE;MAC7BC,KAAK,CAAC,CAAC,MAAMP,aAAa,EAAEM,KAAK,CAAC;IACtC,CAAC,MAAM;MACH,IAAI,CAAC,MAAMN,aAAa,EAAEJ,aAAa,CAACY,MAAM,KAAK,WAAW,EAAE;QAC5DD,KAAK,CAAC,oBAAoB,CAAC;MAC/B;IACJ;EACJ,CAAC;EAED,oBACInC,OAAA,CAACJ,oBAAoB;IAAAyC,QAAA,eACjBrC,OAAA,CAACH,aAAa;MAACyC,QAAQ,EAAE3B,cAAe;MAAA0B,QAAA,gBACpCrC,OAAA;QAAAqC,QAAA,EAAI;MAAsB;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC/B1C,OAAA,CAACV,WAAW;QAAAiD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACf1C,OAAA,CAACF,aAAa;QAAC6C,SAAS,EAAElC,mBAAoB;QAACmC,UAAU,EAAEjD,mBAAmB,CAACkD,QAAS;QAAAR,QAAA,EAAC;MAAS;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAe,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvG;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAE/B,CAAC;AAACtC,EAAA,CA5DID,WAAW;EAAA,QACEZ,SAAS,EACPC,WAAW,EACbJ,WAAW,EACNA,WAAW;AAAA;AAAA0D,EAAA,GAJ7B3C,WAAW;AA8DjB,eAAeA,WAAW;AAAC,IAAA2C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}