{"ast":null,"code":"import { Trie } from \"@wry/trie\";\nimport { canUseWeakMap } from \"../../../utilities/index.js\";\nimport { InternalQueryReference } from \"./QueryReference.js\";\n\nvar SuspenseCache =\n/** @class */\nfunction () {\n  function SuspenseCache(options) {\n    if (options === void 0) {\n      options = Object.create(null);\n    }\n\n    this.queryRefs = new Trie(canUseWeakMap);\n    this.options = options;\n  }\n\n  SuspenseCache.prototype.getQueryRef = function (cacheKey, createObservable) {\n    var ref = this.queryRefs.lookupArray(cacheKey);\n\n    if (!ref.current) {\n      ref.current = new InternalQueryReference(createObservable(), {\n        autoDisposeTimeoutMs: this.options.autoDisposeTimeoutMs,\n        onDispose: function () {\n          delete ref.current;\n        }\n      });\n    }\n\n    return ref.current;\n  };\n\n  SuspenseCache.prototype.add = function (cacheKey, queryRef) {\n    var ref = this.queryRefs.lookupArray(cacheKey);\n    ref.current = queryRef;\n  };\n\n  return SuspenseCache;\n}();\n\nexport { SuspenseCache };","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,QAAqB,WAArB;AAEA,SAASC,aAAT,QAA8B,6BAA9B;AACA,SAASC,sBAAT,QAAuC,qBAAvC;;AAiBA;AAAA;AAAA;AAME,yBAAYC,OAAZ,EAA+D;AAAnD;AAAAA,gBAAgCC,MAAM,CAACC,MAAP,CAAc,IAAd,CAAhC;AAAmD;;AALvD,qBAAY,IAAIL,IAAJ,CAClBC,aADkB,CAAZ;AAMN,SAAKE,OAAL,GAAeA,OAAf;AACD;;AAEDG,kDACEC,QADF,EAEEC,gBAFF,EAEgD;AAE9C,QAAMC,GAAG,GAAG,KAAKC,SAAL,CAAeC,WAAf,CAA2BJ,QAA3B,CAAZ;;AAIA,QAAI,CAACE,GAAG,CAACG,OAAT,EAAkB;AAChBH,SAAG,CAACG,OAAJ,GAAc,IAAIV,sBAAJ,CAA2BM,gBAAgB,EAA3C,EAA+C;AAC3DK,4BAAoB,EAAE,KAAKV,OAAL,CAAaU,oBADwB;AAE3DC,iBAAS,EAAE;AACT,iBAAOL,GAAG,CAACG,OAAX;AACD;AAJ0D,OAA/C,CAAd;AAMD;;AAED,WAAOH,GAAG,CAACG,OAAX;AACD,GAlBD;;AAoBAN,0CAAIC,QAAJ,EAAwBQ,QAAxB,EAAiE;AAC/D,QAAMN,GAAG,GAAG,KAAKC,SAAL,CAAeC,WAAf,CAA2BJ,QAA3B,CAAZ;AACAE,OAAG,CAACG,OAAJ,GAAcG,QAAd;AACD,GAHD;;AAIF;AAAC,CAlCD","names":["Trie","canUseWeakMap","InternalQueryReference","options","Object","create","SuspenseCache","cacheKey","createObservable","ref","queryRefs","lookupArray","current","autoDisposeTimeoutMs","onDispose","queryRef"],"sources":["/media/rk/disk2/React/crwn-clothing-graphql/node_modules/@apollo/src/react/internal/cache/SuspenseCache.ts"],"sourcesContent":["import { Trie } from \"@wry/trie\";\nimport type { ObservableQuery } from \"../../../core/index.js\";\nimport { canUseWeakMap } from \"../../../utilities/index.js\";\nimport { InternalQueryReference } from \"./QueryReference.js\";\nimport type { CacheKey } from \"./types.js\";\n\nexport interface SuspenseCacheOptions {\n  /**\n   * Specifies the amount of time, in milliseconds, the suspense cache will wait\n   * for a suspended component to read from the suspense cache before it\n   * automatically disposes of the query. This prevents memory leaks when a\n   * component unmounts before a suspended resource finishes loading. Increase\n   * the timeout if your queries take longer than than the specified time to\n   * prevent your queries from suspending over and over.\n   *\n   * Defaults to 30 seconds.\n   */\n  autoDisposeTimeoutMs?: number;\n}\n\nexport class SuspenseCache {\n  private queryRefs = new Trie<{ current?: InternalQueryReference }>(\n    canUseWeakMap\n  );\n  private options: SuspenseCacheOptions;\n\n  constructor(options: SuspenseCacheOptions = Object.create(null)) {\n    this.options = options;\n  }\n\n  getQueryRef<TData = any>(\n    cacheKey: CacheKey,\n    createObservable: () => ObservableQuery<TData>\n  ) {\n    const ref = this.queryRefs.lookupArray(cacheKey) as {\n      current?: InternalQueryReference<TData>;\n    };\n\n    if (!ref.current) {\n      ref.current = new InternalQueryReference(createObservable(), {\n        autoDisposeTimeoutMs: this.options.autoDisposeTimeoutMs,\n        onDispose: () => {\n          delete ref.current;\n        },\n      });\n    }\n\n    return ref.current;\n  }\n\n  add(cacheKey: CacheKey, queryRef: InternalQueryReference<unknown>) {\n    const ref = this.queryRefs.lookupArray(cacheKey);\n    ref.current = queryRef;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}